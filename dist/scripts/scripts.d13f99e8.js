"use strict";angular.module("appManager",["ngAnimate","ngSanitize","ngTouch","ui.router","ui.bootstrap"]).config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("dashboard",{url:"/dashboard",templateUrl:"views/states/dashboard.html",controller:"DashboardCtrl"}).state("chat",{url:"/chat",templateUrl:"views/states/chat.html",controller:"ChatCtrl"}),b.otherwise("/dashboard")}]),angular.module("appManager").constant("config",{url:"http://54.255.225.82:8080",vicare:"http://nightly.vicare.vn",api:{question:"/api/questions/",calendar:"/api/calendars/",professional:"/api/v1/professional/"}}),angular.module("appManager").controller("DashboardCtrl",["$scope","$http","config",function(a,b,c){a.data={},a.updateStatus=function(a){b.put(c.url+c.api.question+a._id,{active:a.active}).then(function(a){console.log(a)})};var d=function(){b.get(c.url+c.api.question).then(function(b){a.data.questions=b.data})};d()}]),angular.module("appManager").controller("ChatCtrl",["$scope","$http","config","$uibModal",function(a,b,c,d){a.data={},a.data.times=[{time:"00:00"},{time:"00:30"},{time:"01:00"},{time:"01:30"},{time:"02:00"},{time:"02:30"},{time:"03:00"},{time:"03:30"},{time:"04:00"},{time:"04:30"},{time:"05:00"},{time:"05:30"},{time:"06:00"},{time:"06:30"},{time:"07:00"},{time:"07:30"},{time:"08:00"},{time:"08:30"},{time:"09:00"},{time:"09:30"},{time:"10:00"},{time:"10:30"},{time:"11:00"},{time:"11:30"},{time:"12:00"},{time:"12:30"},{time:"13:00"},{time:"13:30"},{time:"14:00"},{time:"14:30"},{time:"15:00"},{time:"15:30"},{time:"16:00"},{time:"16:30"},{time:"17:00"},{time:"17:30"},{time:"18:00"},{time:"18:30"},{time:"19:00"},{time:"19:30"},{time:"20:00"},{time:"20:30"},{time:"21:00"},{time:"21:30"},{time:"22:00"},{time:"22:30"},{time:"23:00"},{time:"23:30"}],a.today=function(){a.dt=new Date},a.today(),a.clear=function(){a.today()},a.dateOptions={formatYear:"yyyy",maxDate:new Date(2020,5,22),startingDay:1},a.open1=function(){a.popup1.opened=!0},a.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],a.format=a.formats[1],a.altInputFormats=a.formats[1],a.popup1={opened:!1},a.addCalendar=function(b){console.log(b),b.date=a.dt;var c=d.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"./views/modals/time.html",controller:"ModalTimeCtrl",size:"md",resolve:{item:function(){return b}}});c.result.then(function(a){b.professional=a.professional},function(){})},a.$watch("dt",function(a){console.log(a),e()});var e=function(){var d=angular.copy(a.dt),e=d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate();b.get(c.url+c.api.calendar,{params:{date:e}}).then(function(b){console.log(b.data),angular.forEach(a.data.times,function(a){a.professional=null,a.id=null;for(var c=0;c<b.data.length;c++)a.time==b.data[c].time&&(a.professional=b.data[c].professional,a.id=b.data[c]._id,console.log(a))}),console.log(a.data.times)})};e()}]),angular.module("appManager").controller("ModalTimeCtrl",["$scope","item","$http","$uibModalInstance","config",function(a,b,c,d,e){function f(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}console.log(b),a.timeSelected=b,a.search={user:a.timeSelected.professional||[]},console.log(a.search),a.addPro=function(b){for(var c,d=0;d<a.search.user.length;d++)if(b.username==a.search.user[d].name){c=!0;break}c||a.search.user.push(b),a.search.name="",a.search.items=[]},a.removePro=function(b){a.search.user.splice(b,1)},a.added=function(){if(a.timeSelected.id)c.put(e.url+e.api.calendar+a.timeSelected.id,{professional:a.search.user}).then(function(a){d.close(a.data)});else if(a.timeSelected.date&&a.timeSelected.time&&a.search.user.length){var b=angular.copy(a.timeSelected.date),f=b.getFullYear()+"/"+(b.getMonth()+1)+"/"+b.getDate(),g={date:f,time:a.timeSelected.time,professional:a.search.user};c.post(e.url+e.api.calendar,g).then(function(a){d.close(a.data)})}},a.getUser=f(function(){console.log(a.search.name),c.get(e.vicare+e.api.professional,{params:{name:a.search.name}}).then(function(b){console.log(b.data),a.search.items=b.data,a.search.name||(a.search.items=[])})},250)}]),angular.module("appManager").run(["$templateCache",function(a){a.put("views/modals/time.html",'<div class="modal-header"> <h3 class="modal-title" id="modal-title"><i class="glyphicon glyphicon-calendar"></i> {{timeSelected.time}}, {{timeSelected.date | date : \'yyyy/MM/dd\'}}</h3> </div> <div class="modal-body" id="modal-body"> <div class="form-group-vicare"> <div class="label-vicare">Bác sĩ trực</div> <div class="input-vicare"> <input type="text" class="form-control" id="inputEmail3" placeholder="Nhập tên bác sĩ" ng-model="search.name" ng-change="getUser()"> <div class="list-professional" ng-if="search.items.length"> <ul class="list-unstyled"> <li ng-repeat="user in search.items" ng-click="addPro(user)">{{user.id}}: {{user.name}}</li> </ul> </div> </div> </div> <div> <table class="table"> <thead> <tr> <th>STT</th> <th>Bác sĩ</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat="item in search.user"> <td>{{$index}}</td> <td>{{item.name}}</td> <td><button class="btn btn-danger btn-sm" ng-click="removePro($index)"><i class="glyphicon glyphicon-remove"></i></button></td> </tr> </tbody> </table> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="added()">OK</button> <button class="btn btn-warning" type="button" ng-click="">Cancel</button> </div>'),a.put("views/states/chat.html",'<div id="content" class="app-content" role="main"> <div class="app-content-body"> <div class="bg-light lter b-b wrapper-md"> <h1 class="m-n font-thin h3">Danh sách bác sĩ trực</h1> </div> <div class="wrapper-md"> <div class="panel panel-default"> <div class="panel-heading"> Danh sách </div> <div class="row wrapper"> <div class="col-sm-5 m-b-xs"> </div> <div class="col-sm-4"> </div> <div class="col-sm-3"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup="{{format}}" ng-model="dt" is-open="popup1.opened" ng-required="true" close-text="Close" alt-input-formats="altInputFormats"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="open1()"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> </div> <div class="table-responsive"> <table class="table table-striped b-t b-light"> <thead> <tr> <th style="width:100px" class="text-center"> Thời gian </th> <th> Bác sĩ trực </th> <th class="text-center"> </th> </tr> </thead> <tbody> <tr ng-repeat="item in data.times" ng-click="addCalendar(item)"> <td class="text-center">{{item.time}}</td> <td> <span ng-if="item.professional.length">Hiện có {{item.professional.length}} bác sĩ đang trực</span> <span ng-if="!item.professional.length">Hiện không có bác sĩ nào trực</span> </td> <td class="text-center"> <i class="fa fa-check text-success" ng-if="item.professional.length"></i> <i class="glyphicon glyphicon-remove text-error" ng-if="!item.professional.length"></i> </td> </tr> </tbody> </table> </div> </div> </div> </div> </div>'),a.put("views/states/dashboard.html",'<div id="content" class="app-content" role="main"> <div class="app-content-body"> <div class="bg-light lter b-b wrapper-md"> <h1 class="m-n font-thin h3">Danh sách các câu hỏi đến từ app</h1> </div> <div class="wrapper-md"> <div class="panel panel-default"> <div class="panel-heading"> Danh sách </div> <div class="row wrapper"> <div class="col-sm-5 m-b-xs"> <select class="input-sm form-control w-sm inline v-middle"> <option value="0">Bulk action</option> <option value="1">Delete selected</option> <option value="2">Bulk edit</option> <option value="3">Export</option> </select> <button class="btn btn-sm btn-default">Apply</button> </div> <div class="col-sm-4"> </div> <div class="col-sm-3"> <div class="input-group"> <input type="text" class="input-sm form-control" placeholder="Search"> <span class="input-group-btn"> <button class="btn btn-sm btn-default" type="button">Go!</button> </span> </div> </div> </div> <div class="table-responsive"> <table class="table table-striped b-t b-light"> <thead> <tr> <th style="width:20px"> STT </th> <th> Thread ID </th> <th>Thời gian tạo</th> <th>Link</th> <th> Đã trả lời </th> </tr> </thead> <tbody> <tr ng-repeat="item in data.questions"> <td>{{$index}}</td> <td>{{item.thread.id}}</td> <td>{{item.createdAt | date: \'short\'}}</td> <td><a href="{{\'https://vicare.vn\' + item.thread.absolute_url}}" target="_blank">{{\'https://vicare.vn\' + item.thread.absolute_url}}</a></td> <td class="text-center"><label class="i-checks m-b-none"><input type="checkbox" ng-model="item.active" ng-change="updateStatus(item)"><i></i></label></td> </tr> </tbody> </table> </div> </div> </div> </div> </div>')}]);